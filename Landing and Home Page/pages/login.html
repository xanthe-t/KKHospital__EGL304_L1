<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page - KK Hospital </title>
    <link rel="stylesheet" href="/login.css">
</head>

<body>
    <div class="login-container">
        <img src="/KKHospital Logo.jpeg" alt="KK Hospital Logo" class="login-logo">
        <h1>Login</h1>
        <form action="/login" method="POST">
            <div class="input-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter username" required>
            </div>
            <!-- <div class="input-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter password" required>
            </div> -->
           <div class="input-group">
                <label for="password">Password</label>
                <div class="password-wrapper">
                    <input type="password" id="password" name="password" placeholder="Enter password" required>
                    <button type="button" id="togglePassword" class="toggle-password">Show</button>
                </div>
            </div>


            <button type="submit">Login</button>
        </form>

        <!-- Error message placeholder -->
        <p class="error-message" id="error-message" style="display: none;">{{message}}</p>
    </div>
</body>

<script>
function showPopup(message, type = "info") {
    const popup = document.createElement("div");
    popup.className = `popup ${type}`;
    popup.innerText = message;
    document.body.appendChild(popup);
    setTimeout(() => popup.remove(), 3000);
}

// Read query param only once
const params = new URLSearchParams(window.location.search);
const loggedOutType = params.get("loggedOut");

// Show correct message
if (loggedOutType === "idle") {
    showPopup("You have been logged off as you were idle for a minute.", "error");
} else if (loggedOutType === "manual") {
    showPopup("You have successfully logged out.", "success");
}

// Remove query param immediately after showing the popup
if (loggedOutType) {
    const cleanUrl = window.location.pathname;
    window.history.replaceState({}, document.title, cleanUrl);
}

// Show login error messages if any
const errorMessageElement = document.getElementById("error-message");
const errorMessageText = errorMessageElement.textContent.trim();
if (errorMessageText && errorMessageText !== "{{message}}") {
    showPopup(errorMessageText, "error");
    errorMessageElement.style.display = "none";
}


document.getElementById("togglePassword").addEventListener("click", function () {
    const pass = document.getElementById("password");

    if (pass.type === "password") {
        pass.type = "text";
        this.textContent = "Hide";
    } else {
        pass.type = "password";
        this.textContent = "Show";
    }
});
</script>






</html>
